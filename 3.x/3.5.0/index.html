<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<meta name="author" content="Bud Byrd">
<meta name="copyright" content="Apache License, Version 2.0">
<title>RabbitMQ Native Grails Plugin Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>RabbitMQ Native Grails Plugin Documentation</h1>
<div class="details">
<span id="author" class="author">Bud Byrd</span><br>
<span id="revnumber">version 3.5.0,</span>
<span id="revdate">2017-09-17</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_quickstart">1. Quickstart</a>
<ul class="sectlevel2">
<li><a href="#_create_the_application">1.1. Create The Application</a></li>
<li><a href="#_add_the_plugin">1.2. Add The Plugin</a></li>
<li><a href="#_configuring">1.3. Configuring</a></li>
<li><a href="#_consumer">1.4. Consumer</a></li>
<li><a href="#_controller">1.5. Controller</a></li>
<li><a href="#_run_it">1.6. Run it!</a></li>
</ul>
</li>
<li><a href="#_configuration">2. Configuration</a>
<ul class="sectlevel2">
<li><a href="#_server_connection">2.1. Server Connection</a></li>
<li><a href="#_defining_queues">2.2. Defining Queues</a></li>
<li><a href="#_defining_exchanges">2.3. Defining Exchanges</a></li>
<li><a href="#_binding_queues_to_exchanges">2.4. Binding Queues To Exchanges</a></li>
<li><a href="#_binding_exchanges_to_exchanges">2.5. Binding Exchanges to Exchanges</a></li>
</ul>
</li>
<li><a href="#_consuming_messages">3. Consuming Messages</a>
<ul class="sectlevel2">
<li><a href="#_message_handlers">3.1. Message Handlers</a></li>
<li><a href="#_subscribing_to_queues">3.2. Subscribing To Queues</a></li>
<li><a href="#_subscribing_to_exchanges">3.3. Subscribing to Exchanges</a></li>
<li><a href="#_multi_server">3.4. Multi-Server</a></li>
<li><a href="#_central_configuration">3.5. Central Configuration</a></li>
<li><a href="#_consumer_event_handlers">3.6. Consumer Event Handlers</a></li>
</ul>
</li>
<li><a href="#_publishing_messages">4. Publishing Messages</a>
<ul class="sectlevel2">
<li><a href="#_sending_messages">4.1. Sending Messages</a></li>
<li><a href="#_rpc_messages">4.2. RPC Messages</a></li>
<li><a href="#_bulk_publishing">4.3. Bulk Publishing</a></li>
<li><a href="#_publisher_confirms">4.4. Publisher Confirms</a></li>
</ul>
</li>
<li><a href="#_message_converters">5. Message Converters</a>
<ul class="sectlevel2">
<li><a href="#_built_in_message_converters">5.1. Built-in Message Converters</a></li>
<li><a href="#_custom_message_converters">5.2. Custom Message Converters</a></li>
</ul>
</li>
<li><a href="#_advanced_usage">6. Advanced Usage</a>
<ul class="sectlevel2">
<li><a href="#_spring_beans">6.1. Spring Beans</a></li>
<li><a href="#_spring_application_events">6.2. Spring Application Events</a></li>
<li><a href="#_rabbit_context">6.3. Rabbit Context</a></li>
<li><a href="#_transactions">6.4. Transactions</a></li>
</ul>
</li>
<li><a href="#_upgrading">7. Upgrading</a>
<ul class="sectlevel2">
<li><a href="#_from_3_0_x">7.1. From 3.0.X</a></li>
<li><a href="#_from_2_0_x">7.2. From 2.0.X</a></li>
</ul>
</li>
<li><a href="#_reference">8. Reference</a>
<ul class="sectlevel2">
<li><a href="#_command_line">8.1. Command Line</a></li>
<li><a href="#_consumer_configuration">8.2. Consumer Configuration</a></li>
<li><a href="#_rabbit_message_publisher">8.3. Rabbit Message Publisher</a></li>
</ul>
</li>
<li><a href="#_changelog">9. Changelog</a>
<ul class="sectlevel2">
<li><a href="#_3_5_x">9.1. 3.5.x</a></li>
<li><a href="#_3_4_x">9.2. 3.4.x</a></li>
<li><a href="#_3_3_x">9.3. 3.3.x</a></li>
<li><a href="#_3_2_x">9.4. 3.2.x</a></li>
<li><a href="#_3_1_x">9.5. 3.1.x</a></li>
<li><a href="#_3_0_x">9.6. 3.0.x</a></li>
<li><a href="#_2_0_x">9.7. 2.0.x</a></li>
<li><a href="#_1_0_x">9.8. 1.0.x</a></li>
<li><a href="#_0_2_x">9.9. 0.2.x</a></li>
<li><a href="#_0_1_x">9.10. 0.1.x</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The RabbitMQ Native plugin for Grails provides RabbitMQ integration using the Java libraries provided by the RabbitMQ project.
It provides easy configuration of exchanges and queues via a project&#8217;s configuration, simple configuration of consumers, and
a convenience class to easily publish messages.</p>
</div>
<div class="paragraph">
<p>This plugin strives to provide an easy convention to follow to quickly begin consuming messages, but still provide easy
access to the underlying layer to allow users of this plugin to do whatever they need to do outside of those conventions.
It also provides a powerful message body converter system that allows the user to quickly write and plug in converters for
custom data types.</p>
</div>
<div class="paragraph">
<p>This guide details the configuration of the plugin, and may not fully explain the use and conventions of the RabbitMQ services
or its Java library.  More information can be found in their <a href="http://www.rabbitmq.com/api-guide.html">Java API guide</a> and
<a href="http://www.rabbitmq.com/releases/rabbitmq-java-client/current-javadoc/5">JavaDoc</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quickstart">1. Quickstart</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a quick and dirty how-to detailing how to quickly begin using the plugin. While the plugin is very configurable,
this is a very basic demonstration of its usage.</p>
</div>
<div class="sect2">
<h3 id="_create_the_application">1.1. Create The Application</h3>
<div class="paragraph">
<p>Create a project named <strong>RabbitExample</strong>. You can do this by entering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">grails create-app RabbitExample</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_add_the_plugin">1.2. Add The Plugin</h3>
<div class="paragraph">
<p>In the application&#8217;s <code>build.gradle</code> file, under the <code>dependencies</code> section, add:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">    dependencies {
        // ...

        compile "org.grails.plugins:rabbitmq-native:3.5.0"

        // ...
    }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring">1.3. Configuring</h3>
<div class="paragraph">
<p>In <code>grails-app/conf/application.yml</code>, add to the bottom:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/conf/application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    connections:
      - name: main
        host: changeme
        username: changeme
        password: changeme
    queues:
      - name: testqueue</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Be sure to replace the appropriate values for your RabbitMQ server and user credentials.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_consumer">1.4. Consumer</h3>
<div class="paragraph">
<p>Create the a consumer by using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">grails create-consumer com.example.Test</code></pre>
</div>
</div>
<div class="paragraph">
<p>Update the consumer to reflect the following:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/rabbit-consumers/com/example/TestConsumer.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

import com.budjb.rabbitmq.consumer.MessageContext

class TestConsumer {
    /**
     * Consumer configuration.
     */
    static rabbitConfig = [
        queue: "testqueue"
    ]

    /**
     * Handle an incoming RabbitMQ message.
     *
     * @param body    The converted body of the incoming message.
     * @param context Properties of the incoming message.
     * @return
     */
    def handleMessage(def body, MessageContext context) {
        println body
        return "Hello to you, too!"
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_controller">1.5. Controller</h3>
<div class="paragraph">
<p>Create a controller by using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">grails create-controller com.example.Test</code></pre>
</div>
</div>
<div class="paragraph">
<p>Update the controller to reflect the following:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/controllers/com/example/TestController.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

import com.budjb.rabbitmq.publisher.RabbitMessagePublisher

class TestController {
    RabbitMessagePublisher rabbitMessagePublisher

    def index() {
        render rabbitMessagePublisher.rpc {
            routingKey = "testqueue"
            body = "Hello!"
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_run_it">1.6. Run it!</h3>
<div class="paragraph">
<p>Run the grails application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew bootRun</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see the application in action by hitting the test controller. If you&#8217;re running this on your localhost, your URL
may be similar to <code><a href="http://localhost:8080/test/index" class="bare">http://localhost:8080/test/index</a></code>. You should see the message "Hello!" printed the
application&#8217;s output console, and your web browser should display the message "Hello to you, too!".</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">2. Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Configuration of the connection to the RabbitMQ server is done in your project&#8217;s <code>grails-app/conf/application.groovy</code> or
<code>grails-app/conf/application.yml</code> file.</p>
</div>
<div class="paragraph">
<p>Below is the list of general configuration properties.</p>
</div>
<table class="tableblock frame-all grid-rows spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enabled</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If false, will register the plugin&#8217;s beans, but prevent the plugin connecting to the RabbitMQ broker(s) and consuming messages.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enableSerializableConverter</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, enables the use of a converter that handles Java serialization.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_server_connection">2.1. Server Connection</h3>
<div class="paragraph">
<p>The plugin expects the connection configuration to the RabbitMQ server to be defined. A bare minimum configuration
example looks like:</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    connections = [
        [
            name: "defaultConnection",
            host: "example.com",
            username: "foo",
            password: "bar"
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    connections:
      - name: defaultConnection
        host: example.com
        username: foo
        password: bar</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>connections</code> section should contain a list of maps, where each entry in the list represents an individual
connection.</p>
</div>
<div class="paragraph">
<p>Connections to many different RabbitMQ servers can be configured.  A multi-server configuration looks like:</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    connections = [
        [
            name: "connection1",
            host: "rabbit1.example.com",
            username: "foo",
            password: "bar"
        ],
        [
            name: "connection2",
            host: "rabbit2.example.com",
            username: "foo",
            password: "bar"
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    connections:
      - name: connection1
        host: rabbit1.example.com
        username: foo
        password: bar

      - name: connection2
        host: rabbit2.example.com
        username: foo
        password: bar</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following table enumerates all the configuration options available to the connection configuration:</p>
</div>
<table class="tableblock frame-all grid-rows spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the connection, which can be used to tie queues and exchanges to a particular connection.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hostname or IP address of the RabbitMQ server to connect to.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Username to log into the RabbitMQ server with.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password to log into the RabbitMQ server with.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isDefault</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A connection with this set to true will be the server messages are sent to if no specific connection is specified when sending the message.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>port</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Port to connect to the RabbitMQ server with.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5672</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtualHost</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the virtual host to connect to the RabbitMQ server with.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ssl</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to use SSL when connecting to a RabbitMQ server.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>threads</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Threadpool size, if greater than 0, determines how many concurrent messages can be processed at any given time. If set to 0, consumers can consume as many messages as it&#8217;s configured to.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>automaticReconnect</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, will cause the application to automatically reconnect to a server when its connection is dropped.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>requestedHeartbeat</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Heartbeat interval, in seconds. A value of <code>0</code> disables heartbeats.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enableMetrics</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, will create a metric registry and associate it for the connection via DropWizard.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_defining_queues">2.2. Defining Queues</h3>
<div class="paragraph">
<p>The plugin allows authors to define the exchanges and queues programatically inside the configuration. This allows the
application to configure its own queues without someone having to manually create the exchanges and queues prior to
running the application.</p>
</div>
<div class="paragraph">
<p>Queue configuration is also done in the rabbitmq block, much as the server connection is configured. Usage is best
illustrated with an example:</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    connections = [
        // ...
    ]
    queues = [
        [
            name: "example.queue",
            durable: true,
            exchange: "example.exchange"
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    connections:
        # ...
    queues:
      - name: example.queue
        durable: true
        exchange: example.exchange</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above code will define a queue named <strong>example.queue</strong>, and its durable flag will be set.</p>
</div>
<div class="paragraph">
<p>If using the multi-server feature of the plugin, it is important to consider what server the queue should be defined in.
The <code>connection</code> property specifies which server to create the queue in, illustrated below:</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    queues = [
        // Assume there is a connection with the name "server1"...
        [
            name: "example.queue",
            connection: "server1",
            durable: true
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    queues:
        # Assume there is a connection with the name "server1"...
      - name: example.queue
        connection: server1
        durable: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Below is a table of all of the options available when defining queues:</p>
</div>
<table class="tableblock frame-all grid-rows spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the queue.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>arguments</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extra arguments used to create the queue. See the <a href="http://www.rabbitmq.com/documentation.html">RabbitMQ documentation</a> for more information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>autoDelete</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to automatically delete the queue once there are no more consumers listening to it.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>binding</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used in conjunction with exchanges. See the section below for more information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Mixed</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>durable</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether messages should be persisted to the disk on the RabbitMQ server to survive server restarts.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>exchange</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binds a queue to an exchange in conjunction with the <code>binding</code> property. Ignored if used inside an exchange declaration.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>match</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required when binding to a headers exchange. Either "any" or "all".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>connection</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the connection to create the queue with.  Uses the default connection if omitted.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_defining_exchanges">2.3. Defining Exchanges</h3>
<div class="paragraph">
<p>Defining exchanges is very similar to defining queues. The following code illustrates how to define an exchange:</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    exchanges = [
        [
            name: "example.exchange",
            type: "topic"
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    exchanges:
      - name: example.exchange
        type: topic</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example will create an exchange with the name <strong>example.exchange</strong> and of the type <strong>topic</strong>. Below is a list of
all the options available when creating exchanges:</p>
</div>
<table class="tableblock frame-all grid-rows spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the exchange.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>arguments</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extra arguments used to create the exchange. See the <a href="http://www.rabbitmq.com/documentation.html">RabbitMQ documentation</a> for more information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>autoDelete</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to automatically delete the exchange once there are no longer any queues bound to it.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>durable</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether messages should be persisted to the disk on the RabbitMQ server to survive server restarts.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One of "fanout", "topic", "direct", or "headers".</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>connection</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the connection to create the exchange with.  Uses the default connection if omitted.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_binding_queues_to_exchanges">2.4. Binding Queues To Exchanges</h3>
<div class="paragraph">
<p>Queues can be bound to an exchange by setting the <code>exchange</code> and <code>binding</code> properties in the queue&#8217;s configuration. The
value of the binding depends on the type of exchange the queue is being bound to. Each exchange type is explained below.</p>
</div>
<div class="paragraph">
<p>This basic example will create a <strong>topic</strong> exchange named <strong>example.exchange</strong>, as well as create a queue named
<strong>example.queue</strong>. The queue will be bound to the exchange with the topic, or routing key, of <code>sample.binding.#</code>.</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    queues = [
        [
            name: "example.queue",
            exchange: "example.exchange",
            binding: "sample.binding.#"
        ]
    ]
    exchanges = [
        [
            name: "example.exchange",
            type: "topic"
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    queues:
      - name: example.queue
        exchange: example.exchange
        binding: 'sample.binding.#'
    exchanges:
      - name: example.exchange
        type: topic</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The <code><mark></code> character is used frequently with RabbitMQ bindings. The <code></mark></code> character is also special in YAML, so it is
important that strings using the <code>#</code> character are quoted so that the YAML engine will treat it as plain text.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Queues need to have their binding defined specifically for the type of exchange they are bound to.</p>
</div>
<div class="sect3">
<h4 id="_fanout_exchanges">2.4.1. Fanout Exchanges</h4>
<div class="paragraph">
<p>Fanout exchanges are the easiest to configure bindings for, since they require none. Fanout exchanges simply send every
message it receives to every queue bound to it.</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    queues = [
        [
            name: "example.queue",
            exchange: "example.exchange"
        ]
    ]
    exchanges = [
        [
            name: "example.exchange",
            type: "fanout"
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    queues:
      - name: example.queue
        exchange: example.exchange
    exchanges:
      - name: example.exchange
        type: fanout</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_topic_exchanges">2.4.2. Topic Exchanges</h4>
<div class="paragraph">
<p>Topic exchanges require queues to define a topic. Topics can be an exact match, but their strength is in their partial
matching ability. See the <a href="http://www.rabbitmq.com/documentation.html">RabbitMQ documentation</a> for details about this
kind of exchange.</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    queues = [
        [
            name: "example.queue",
            exchange: "example.exchange",
            binding: "example.binding.#"
        ]
    ]
    exchanges = [
        [
            name: "example.exchange",
            type: "topic"
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    queues:
      - name: example.queue
        exchange: example.exchange
        binding: 'example.binding.#'
    exchanges:
      - name: example.exchange
        type: topic</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_direct_exchanges">2.4.3. Direct Exchanges</h4>
<div class="paragraph">
<p>Direct exchanges are similar to topic exchanges, except that their "topics" only function with direct name matching.
The appropriate name for the binding in this case is "routing key". Queues must define a routing key when binding to
this type of exchange.</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    queues = [
        [
            name: "example.queue",
            exchange: "example.exchange",
            binding: "exampleRoutingKey"
        ]
    ]
    exchanges = [
        [
            name: "example.exchange",
            type: "direct"
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    queues:
      - name: example.queue
        exchange: example.exchange
        binding: exampleRoutingKey
    exchanges:
      - name: example.exchange
        type: direct</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_header_exchanges">2.4.4. Header Exchanges</h4>
<div class="paragraph">
<p>Header exchanges are like topic exchanges, but with the ability to define multiple match keywords. The binding for
queues allows the queue to match on all or one of multiple header values. The queue must also set the <code>match</code> property
for this exchange type, and the value must be one of "any" or "all".</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    queues = [
        [
            name: "example.queue",
            match: "any",
            binding: [
                "header1": "header-value-1",
                "header2": "header-value-2"
            ]
        ]
    ]
    exchanges = [
        [
            name: "example.exchange",
            type: "headers"
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    queues:
      - name: example.queue
        match: any
        binding:
            header1: header-value-1
            header2: header-value-2
    exchanges:
      - name: example.exchange
        type: headers</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_binding_exchanges_to_exchanges">2.5. Binding Exchanges to Exchanges</h3>
<div class="paragraph">
<p>Exchanges can also be bound to other exchanges to create richer routing topologies. More information can be found
<a href="https://www.rabbitmq.com/e2e.html">here</a>.</p>
</div>
<div class="paragraph">
<p>This basic example will create 2 exchanges, with a binding that will forward messages from <code>source-exchange</code> to
<code>target-exchange</code> when messages match the routing key <code>foo.bar.#</code>.</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    exchanges = [
        [
            name: "source-exchange",
            type: "topic",
            exchangeBindings: [
                [ exchange: "target-exchange", binding: "foo.bar.#" ]
            ]
        ],
        [
            name: "target-exchange",
            type: "direct"
        ]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    exchanges:
      - name: source-exchange
        type: topic
        exchangeBindings:
          - exchange: target-exchange
            binding: 'foo.bar.#'
        name: target-exchange
        type: direct</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_consuming_messages">3. Consuming Messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Consuming messages is accomplished by creating a message consumer class. Consumer classes are placed into the
<code>grails-app/rabbit-consumers</code>, and must end with <code>Consumer.groovy</code>. These classes are Spring beans, meaning
that they can inject other Spring beans such as services, the <code>grailsApplication</code> instance, etc. Each consumer
class must be configured in a certain way. If there is a misconfiguration in a consumer, the plugin will log
an error stating so and not register the consumer to any queues.</p>
</div>
<div class="sect2">
<h3 id="_message_handlers">3.1. Message Handlers</h3>
<div class="paragraph">
<p>One of the requirements for a consumer to be registered to the RabbitMQ server is that a message handler be declared
in the consumer class. The message handler is the mechanism by which messages are consumed.</p>
</div>
<div class="sect3">
<h4 id="_basic_usage">3.1.1. Basic Usage</h4>
<div class="paragraph">
<p>In its most basic form, a message handler method takes in the body of the received message, and a <code>MessageContext</code>
object that contains the message parameters received from the RabbitMQ server, along with the consumer&#8217;s channel
that the handler should publish messages through.</p>
</div>
<div class="paragraph">
<p>This is the most generic form of a message handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

import com.budjb.rabbitmq.consumer.MessageContext

class ExampleConsumer {
    // ...

    def handleMessage(def body, MessageContext context) {
        // Do work
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_typed_message_handlers">3.1.2. Typed Message Handlers</h4>
<div class="paragraph">
<p>The logic surrounding the message consumer classes will by default attempt to intelligently convert the body of
the received message from a byte array to a converted type, such as a String. Before routing the message to the
consumer and handler, the plugin will run through a list of <a href="#_message_converters">Message Converters</a>, limited by the class types
of the handlers defined in the message consumer, and attempt to find a conversion that works.</p>
</div>
<div class="paragraph">
<p>For example, consider this JSON blob:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-json" data-lang="json">{"foo":"bar","hi":"there"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the above message is received, the converter for the Map class type will convert the byte array to a Map
of the JSON data. If a valid handler for the Map type is defined, the handler will receive the converted JSON.</p>
</div>
<div class="paragraph">
<p>The following handlers would accept the converted map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

import com.budjb.rabbitmq.consumer.MessageContext

class ExampleConsumer {
    // ...

    def handleMessage(Map body, MessageContext context) {
        // Do work
    }

    def handleMessage(def body, MessageContext context) {
        // Since def is a generic type (Object)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If no converter is able to convert the message body, the plugin will fall back to passing the handler the raw
byte array received from the RabbitMQ server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
More information about message converters can be found in the <a href="#_message_converters">Message Converters</a> section, including a list
of built-in message converters and details of how to create custom converters.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_short_form_usage">3.1.3. Short-Form Usage</h4>
<div class="paragraph">
<p>In addition to the 2-parameter handler method signature, there are 2 shortcut versions available for use. One form only
takes the converted message body, and the other only takes the <code>MessageContext</code> object.</p>
</div>
<div class="paragraph">
<p>The short-form handlers are shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

import com.budjb.rabbitmq.consumer.MessageContext

class ExampleConsumer {
    // ...

    def handleMessage(String message) {
        // Do work
    }

    def handleMessage(MessageContext context) {
        // Do work
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>MessageContext</code>-only handler will only be called if there is no other handler defined that can possibly
handle any conversion of the message body.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_messagecontext_object">3.1.4. MessageContext Object</h4>
<div class="paragraph">
<p>The message context is just an object that encapsulates the data relevant to the received message.  Below
is a list of properties of the class.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>body</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incoming message in its raw <code>byte[]</code> format.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>channel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RabbitMQ channel the message handler should use to publish messages. This is especially important when using transactions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>consumerTag</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consumer tag</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>envelope</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Properties of the message&#8217;s delivery (see RabbitMQ&#8217;s <a href="http://www.rabbitmq.com/releases/rabbitmq-java-client/current-javadoc/com/rabbitmq/client/Envelope.html">documentation</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>properties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Properties of the message (see RabbitMQ&#8217;s <a href="http://www.rabbitmq.com/releases/rabbitmq-java-client/current-javadoc/com/rabbitmq/client/BasicProperties.html">documentation</a>)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_rpc_style_messages">3.1.5. RPC-Style Messages</h4>
<div class="paragraph">
<p>When a client publishes a message and waits for a return reply, this is considered an RPC-style operation. Typically, the server-side of the operation (in this case, a message consumer/handler) must
respond to the client on a queue that the client requested manually. This plugin provides a very convenient method to respond to the client without having to manually construct a response message.</p>
</div>
<div class="paragraph">
<p>The client will provide a response queue to the server to reply to. This queue name is stored in the <code>MessageContext.properties.replyTo</code> variable. If a client publishes
this variable, and the handler returns some data, the plugin will convert the data returned from the message handler and build a response message for you.</p>
</div>
<div class="paragraph">
<p>The following example illustrates responding via a handler&#8217;s returned data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class RpcExampleConsumer {
    def handleMessage(String message, MessageContext messageContext) {
        println "received ${message}"

        return "response" // this message will be sent back to the consumer via its replyTo queue
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, the <code>rabbitMessagePublisher</code> can be used to respond.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">class RpcExampleConsumer {
    def rabbitMessagePublisher

    def handleMessage(String message, MessageContext messageContext) {
        println "received ${message}"

        rabbitMessagePublisher.send {
            routingKey: messageContext.properties.replyTo
            body: "response"
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Allowing the plugin to build a reply message only converts the data returned from the message handler and publishes it to the reply queue. If you need to set any of the other message properties,
like headers, content-types, etc, you must manually build the response message using the <code>rabbitMessagePublisher</code>, and refrain from returning data from the message handler.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_handling_unsupported_messages">3.1.6. Handling Unsupported Messages</h4>
<div class="paragraph">
<p>As long as there is a converter that can convert an incoming message and a handler defined that accepts the converted
object, messages can be delivered. In the case where an incoming message can not be converted and there is no possible
way to provide the message to a handler, an error is logged by default and the message is rejected.</p>
</div>
<div class="paragraph">
<p>Message consumers that need to conduct some logic when this occurs may implement the <code>UnsupportedMessageHandler</code>
interface, which requires the <code>handleUnsupportedMessage</code> method. When no handler and converter exist for a message,
this method is called and the <code>MessageContext</code> is passed in, giving the consumer some way to gracefully handle input
failures. Objects may even be returned, much like regular handlers, as a response to an RPC call.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subscribing_to_queues">3.2. Subscribing To Queues</h3>
<div class="paragraph">
<p>Message consumers can subscribe to either queues or exchanges. When a consumer is registered to a queue, the consumer will receive messages from the queue as
the RabbitMQ server determines that it&#8217;s the consumer&#8217;s turn to receive a message, since there may be multiple listeners on the same queue.</p>
</div>
<div class="paragraph">
<p>Each message consumer class must have a configuration defined. There are 2 methods to specify the configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The consumer class can have a <code>Map</code> assigned to a static variable named <code>rabbitConfig</code>. To subscribe to queues, the only required configuration option is the <code>queue</code> variable, which is the name of the queue to subscribe to.</p>
</li>
<li>
<p>The application&#8217;s configuration file can contain the configuration with the path <code>rabbitmq.consumers.&lt;ClassName&gt;</code>.  See the section below for more details.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is a simple example of a consumer subscribing to a queue.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

import com.budjb.rabbitmq.consumer.MessageContext

class ExampleConsumer {
    static rabbitConfig = [
        "queue": "test.queue"
    ]

    def handleMessage(def body, MessageContext context) {
        // Process message
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are many options available to influence how the consumer works, which can be found in the reference.</p>
</div>
</div>
<div class="sect2">
<h3 id="_subscribing_to_exchanges">3.3. Subscribing to Exchanges</h3>
<div class="paragraph">
<p>Subscribing to a exchanges is different from subscribing to queues, as there are different types of exchanges with different behavior.
RabbitMQ&#8217;s libraries do not provide a direct way to subscribe to an exchange, however the plugin provides a way to subscribe to exchanges directly by creating
a temporary queue that is bound to an exchange. The binding requirements differ between the different types of exchanges.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Using the functionality to subscribe to an exchange works by creating a temporary queue at runtime that is bound to the exchange and consumed from by
the message consumer.  It is important to note that these queues are randomly named and are exclusive and auto delete, so this feature is not
suitable if messages that are left on this queue should persist if the application shuts down.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_fanout_exchanges_2">3.3.1. Fanout Exchanges</h4>
<div class="paragraph">
<p>A fanout exchange will forward a received message to every queue bound to it. There is no binding criteria for this kind of exchange.
This is the simplest type of exchange, and is also the easiest to configure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

class ExampleConsumer {
    static rabbitConfig = [
        "exchange": "fanout.exchange"
    ]

    def handleMessage(def body, MessageContext context) {
        // Process message
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_topic_exchanges_2">3.3.2. Topic Exchanges</h4>
<div class="paragraph">
<p>A topic exchange will forward messages to queues based on the binding criteria the queue used to register to the exchange. In RabbitMQ terms,
this is called a routing key. The routing key can be either a direct match, or utilize wildcards to do a partial topic match. If a routing key
is omitted, the queue will receive no messages. Use <code>"#"</code> to receive all messages from an exchange.
More information can be found in the RabbitMQ documentation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

class ExampleConsumer {
    static rabbitConfig = [
        "exchange": "topic.exchange",
        "binding": "foo.bar.#"
    ]

    def handleMessage(def body, MessageContext context) {
        // Process message
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_direct_exchanges_2">3.3.3. Direct Exchanges</h4>
<div class="paragraph">
<p>A direct exchange will forward messages to queues based on binding criteria configured similarly to topic exchanges.
The difference in this case is that direct routing does not utilize wildcards in their routing keys.</p>
</div>
<div class="paragraph">
<p>h4. Direct Example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

class ExampleConsumer {
    static rabbitConfig = [
        "exchange": "direct.exchange",
        "binding": "example"
    ]

    def handleMessage(def body, MessageContext context) {
        // Process message
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_headers_exchanges">3.3.4. Headers Exchanges</h4>
<div class="paragraph">
<p>Header exchanges work similarly to topic exchanges. A headers exchange will forward messages to queues based on header values contained
in messages. Additionally, a queue can be bound on multiple header values, along with an option to require one or all of the headers
to match.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

class ExampleConsumer {
    static rabbitConfig = [
        "exchange": "headers.exchange",
        "binding": [
            "foo": "bar",
            "hi": "there"
        ],
        "match": "any"
    ]

    def handleMessage(def body, MessageContext context) {
        // Process message
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multi_server">3.4. Multi-Server</h3>
<div class="paragraph">
<p>When using a multi-server setup, it is important to consider what server a consumer should listen on.  Use the <code>connection</code> property in the <code>rabbitConfig</code>
to specify which server the consumer should be bound to.  If the <code>connection</code> is omitted, the consumer will be bound to the default connection.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

class ExampleConsumer {
    static rabbitConfig = [
        "queue": "test.queue",
        "connection": "server1" // Where "server1" is a connection configured with that name.
    ]

    def handleMessage(def body, MessageContext context) {
        // Do work
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_central_configuration">3.5. Central Configuration</h3>
<div class="paragraph">
<p>It is also possible to define the consumer&#8217;s configuration outside of the consumer in the application&#8217;s configuration
file.  All of the configuration options described above are valid for this type of configuration. This functionality is
valuable when a consumer&#8217;s configuration needs to be determined at runtime, instead of being hardcoded in the consumer
class itself.</p>
</div>
<div class="paragraph">
<p>To configuration a consumer in the Grails application&#8217;s configuration file, an entry matching the consumer&#8217;s class name
should be present under the <code>rabbitmq.consumers</code> key, as follows:</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitmq {
    consumers {
        ExampleConsumer {
            queue = "test.queue"
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">rabbitmq:
    consumers:
        ExampleConsumer:
            queue: test.queue</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_consumer_event_handlers">3.6. Consumer Event Handlers</h3>
<div class="paragraph">
<p>It may be useful to execute some logic at certain times during the message delivery lifecycle. To enable this, the
<code>MessageConsumerEventHandler</code> trait exists that provides several hooks or event handlers, which are called at various
times during the message delivery.</p>
</div>
<div class="paragraph">
<p>The trait provides empty bodies for all of its methods and so implementations of the trait need only override the
specific event handlers that are required.</p>
</div>
<table class="tableblock frame-all grid-rows spread">
<caption class="title">Table 1. Event Handlers</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>onReceive(MessageContext)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Called when a message is initially received by the underlying RabbitMQ
                                              system and before handed to the message consumer class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>onSuccess(MessageContext)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Called when a message has been successfully delivered and processed by the message consumer class.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>onFailure(MessageContext, Throwable)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Called when some unhandled exception occurred during the process of
                                              delivering or processing the message. This event handler differs from the
                                              rest in that the unhandled exception is provided.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>onComplete(MessageContext)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Called when the delivery process is complete, whether it was successful or
                                              failed. This event handler will be called even when <code>onSuccess</code> or
                                              <code>onFailure</code> are called.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_publishing_messages">4. Publishing Messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Publishing messages through the plugin is achieved by using the <code>rabbitMessagePublisher</code> bean. This Spring bean utilizes a closure-based configuration method to
both send messages without waiting for a response, and sending rpc-style messages. There are many options available to the <code>rabbitMessagePublisher</code> which are
documented in the reference, but this guide will only demonstrate basic usage.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In a multi-server setup, it is important to consider what server to send a message to. Like configuration and consumers, the <code>connection</code> property
is used to route the message to the proper server connection.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_sending_messages">4.1. Sending Messages</h3>
<div class="paragraph">
<p>Sending a message means publishing a message to an exchange or queue and not waiting for a response (fire and forget). The only required parameters to the publisher
are a queue or exchange to publish the message to, and the body of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import com.budjb.rabbitmq.publisher.RabbitMessagePublisher

class ExampleService {
    RabbitMessagePublisher rabbitMessagePublisher

    def sendSomeMessage() {
        rabbitMessagePublisher.send {
            exchange = "some.exchange"
            routingKey = "some.routingKey"
            body = "hi!"
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>RabbitMQ expects the body of a message to be a byte array. Message converters will also work when publishing messages, so if an object type other than <code>byte[]</code> is
encountered, a suitable message converter will be found and run against the message body, if one exists.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rpc_messages">4.2. RPC Messages</h3>
<div class="paragraph">
<p>Publishing an RPC message is as easy as sending messages, except the returned message is returned from the function.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import com.budjb.rabbitmq.publisher.RabbitMessagePublisher

class ExampleService {
    RabbitMessagePublisher rabbitMessagePublisher

    def sendSomeMessage() {
        def result = rabbitMessagePublisher.rpc {
            exchange = "some.exchange"
            routingKey = "some.routingKey"
            body = "hi!"
            timeout = 5000
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The <code>timeout</code> option is especially important for RPC-style messages. The timeout property is the amount of time (in milliseconds)
the client will wait for the server to respond. If the timeout is reached, a <code>TimeoutException</code> will be thrown. If the timeout is set to 0, the client
will wait indefinitely for a response. The default value of the timeout, if not passed, is 5 seconds.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_bulk_publishing">4.3. Bulk Publishing</h3>
<div class="paragraph">
<p>By default, the publisher opens a new channel for each message it publishes. This is acceptable when sending
individual messages, but when bulk publishing is required, it is much more efficient to open a single channel
and use it for batches of messages.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As an example, during testing it took about 65 milliseconds to send one message.  If 1000 messages are sent,
the total time to publish is about 65 seconds! Using a single channel for the same operation takes about
1 millisecond per message, cutting the time down to 1 second for all 1000 messages.</p>
</div>
<div class="paragraph">
<p>These times are just an example based on testing, but they will differ based on network latency and server load.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>While a channel may be manually created by authors using the <code>rabbitContext</code>, the publisher provides an easy way
to send many messages with a single channel.  See the example below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.withChannel { channel -&gt;
    1000.times { i -&gt;
        send {
            routingKey = "foobar"
            body = "Bulk message $i"
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is also a <code>withChannel</code> method that takes in a connection name for multi-server setups.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.withChannel("connection1") { channel -&gt;
    1000.times { i -&gt;
        send {
            routingKey = "foobar"
            body = "Bulk message $i on connection1"
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All of the <code>send</code> and <code>rpc</code> methods available with the publisher can be used with <code>withChannel</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_publisher_confirms">4.4. Publisher Confirms</h3>
<div class="paragraph">
<p>The publisher allows authors to enable publisher confirms for a batch of messages using a similar mechanism as
<code>withChannel</code>.  These methods use RabbitMQ&#8217;s <code>waitForConfirms</code> and <code>waitForConfirmsOrDie</code> methods.  See
RabbitMQ&#8217;s documentation for more information about how publisher confirms work.</p>
</div>
<div class="paragraph">
<p>The reference details all of the various methods that the publisher contains to support confirms, but
below are a couple of basic examples.</p>
</div>
<div class="paragraph">
<p>The <code>withConfirms</code> methods utilize the <code>waitForConfirms</code> methods from the RabbitMQ Java library.  <code>withConfirms</code> will
block until all messages sent in the provided closure have been acked or n&#8217;acked by the server.  If a timeout
is specified, it will only wait for the amount of time specified before throwing a <code>TimeoutException</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.withConfirms { channel -&gt;
    send {
        routingKey = "foobar"
        body = "I am a test message"
    }

    send {
        routingKey = "barbaz"
        body = "I am also a test message"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>withConfirmsOrDie</code> methods utilize the <code>waitForConfirmsOrDie</code> methods from the RabbitMQ Java library.
<code>withConfirmsOrDie</code> will block until all messages sent in the provided closure have been acked or n&#8217;acked by the
server.  The difference with this method is that if any n&#8217;ack is received, an exception is thrown.
As with <code>withConfirms</code>, a timeout can be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.withConfirmsOrDie { channel -&gt;
    send {
        routingKey = "foobar"
        body = "I am a test message"
    }

    send {
        routingKey = "barbaz"
        body = "I am also a test message"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are versions of both of these types of methods that take a connection name and/or a timeout.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_message_converters">5. Message Converters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Message converters are classes that are responsible for converting objects to and from byte arrays.</p>
</div>
<div class="sect2">
<h3 id="_built_in_message_converters">5.1. Built-in Message Converters</h3>
<div class="paragraph">
<p>The plugin provides converters for the following types:</p>
</div>
<table class="tableblock frame-all grid-rows spread">
<caption class="title">Table 2. Built-in Message Converters</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incoming</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outgoing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Serializable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map</code> (JSON)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TypeConvertingMap</code> (JSON)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List</code> (JSON)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GString</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images//check.svg" alt="36" width="36"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>These converters allow message handlers to consume and return data without having to convert that data themselves. They
are also used when publishing messages with the <code>RabbitMessagePublisher</code>.</p>
</div>
<div class="paragraph">
<p>INFO: The message converter for <code>Serializable</code> classes will always be attempted first.</p>
</div>
<div class="paragraph">
<p>INFO: <code>Serializable</code> converter is off by default. set <code>rabbitmq.enableSerializableConverter</code>, to <code>true</code> to enable this feature.</p>
</div>
</div>
<div class="sect2">
<h3 id="_custom_message_converters">5.2. Custom Message Converters</h3>
<div class="paragraph">
<p>The plugin provides a way for authors to create their own message converters. A custom message converter must be placed
in the <code>grails-app/rabbit-converters</code> path, and must end with <code>Converter.groovy</code>.</p>
</div>
<div class="paragraph">
<p>A message converter must implement the appropriate interface for the type of conversion it supports. The
<code>ByteToObjectConverter</code> interface is used when a converter supports incoming messages from RabbitMQ, while the
<code>ObjectToByteConverter</code> interface is used when a converter supports outgoing messages to RabbitMQ. Classes that support
both should implement both interfaces.</p>
</div>
<div class="paragraph">
<p>Message converters advertise what objects and MIME types it supports. The conversion system will typically attempt to
first match an incoming message with a converter matching its MIME type, if it was provided. Message converters that are
aware of the MIME types it supports provides the conversion system with a more accurate type detection ability.
Additionally, converters may apply a MIME type to outgoing messages if one has not already been defined.</p>
</div>
<div class="paragraph">
<p>Below is an example converter for the String object type. Custom converters should follow the same format.</p>
</div>
<div class="listingblock">
<div class="title">StringMessageConverter</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.budjb.rabbitmq.converter

import groovy.transform.CompileStatic
import org.springframework.util.MimeType

/**
 * A converter that supports conversion to and from a {@link String}.
 */
@CompileStatic
class StringMessageConverter implements ByteToObjectConverter, ObjectToByteConverter {
    /**
     * Mime type.
     */
    private static final MimeType mimeType = MimeType.valueOf('text/plain')

    /**
     * {@inheritDoc}
     */
    @Override
    boolean supports(Class&lt;?&gt; type) {
        return String.isAssignableFrom(type)
    }

    /**
     * {@inheritDoc}
     */
    @Override
    boolean supports(MimeType mimeType) {
        return mimeType.isCompatibleWith(this.mimeType)
    }

    /**
     * {@inheritDoc}
     */
    @Override
    ByteToObjectResult convert(ByteToObjectInput input) {
        return new ByteToObjectResult(new String(input.getBytes(), input.getCharset()))
    }

    /**
     * {@inheritDoc}
     */
    @Override
    ObjectToByteResult convert(ObjectToByteInput input) {
        return new ObjectToByteResult(
            ((String) input.getObject()).getBytes(input.getCharset()),
            new MimeType(mimeType, input.getCharset())
        )
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced_usage">6. Advanced Usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While the plugin effectively wraps the functionality of the RabbitMQ library, the end user has direct access to all of the underlying library objects and connection instances.</p>
</div>
<div class="sect2">
<h3 id="_spring_beans">6.1. Spring Beans</h3>
<div class="paragraph">
<p>The are several beans defined by the plugin to perform its various operations.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bean Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Purpose</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rabbitContext</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A front-end class to the plugin that aggregates useful functionality for users of the
                                plugin.  Besides the <code>rabbitMessagePublisher</code>, this is likely the only bean users will
                                need to access, if at all.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>connectionManager</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manages the lifecycle of connection instances, including loading, starting, stopping,
                                unloading, and retrieval.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>messageConverterManager</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Handles loading message converters and acts as the entry point when message conversion
                                is required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>consumerManager</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manages the lifecycle of consumer instances, including loading, starting, stopping,
                                unloading, and retrieval.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>queueBuilder</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Responsible for creating exchanges and queues defined in the application&#8217;s configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rabbitMessagePublisher</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to send messages to a RabbitMQ broker.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_spring_application_events">6.2. Spring Application Events</h3>
<div class="paragraph">
<p>The plugin provides several <a href="https://docs.spring.io/spring-integration/reference/html/applicationevent.html">application events</a>
that applications using the plugin may be interested in. They are particularly useful when some logic needs to execute
during the startup and shutdown lifecycle of the plugin.</p>
</div>
<table class="tableblock frame-all grid-rows spread">
<caption class="title">Table 3. Application Events</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Event Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RabbitContextStartingEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before the <code>RabbitContext</code> is started. This is useful when
                                      code needs to execute before connections and consumers start.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RabbitContextStartedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published after the <code>RabbitContext</code> is started. This is useful when
                                      code needs to execute after connections and consumers are started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RabbitContextStoppingEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before the <code>RabbitContext</code> is stopped. This is useful when
                                      code needs to execute before connections and consumers are stopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RabbitContextStoppedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published after the <code>RabbitContext</code> is stopped. This is useful when
                                      code needs to execute after connections and consumers are stopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConsumerManagerStartingEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before all consumers are started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConsumerManagerStartedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published after all consumers are started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConsumerManagerStoppingEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before all consumers are stopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConsumerManagerStoppedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published after all consumers are stopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConsumerContextStartingEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before a specific consumer is started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConsumerContextStartedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published after a specific consumer is started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConsumerContextStoppingEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before a specific consumer is stopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConsumerContextStoppedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before a specific consumer is stopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConnectionManagerStartingEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before all connections are started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConnectionManagerStartedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published after all connections are started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConnectionManagerStoppingEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before all connections are stopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConnectionManagerStoppedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published after all connections are stopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConnectionContextStartingEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before a specific connection is started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConnectionContextStartedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published after a specific connection is started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConnectionContextStoppingEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published before a specific connection is stopped.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConnectionContextStoppedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published after a specific connection is stopped.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Events can be consumed by registering a bean that implements the <code>ApplicationListener</code> interface. The interface is
generic and takes the type of event it wants to listen for. Below is an example of a listener that&#8217;s interested in
the <code>RabbitContextStartingEvent</code> event.</p>
</div>
<div class="listingblock">
<div class="title">grails-app/init/Application.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

import com.example.MyRabbitContextStartingEventListener
import grails.boot.GrailsApp
import grails.boot.config.GrailsAutoConfiguration
import org.springframework.context.annotation.Bean

class Application extends GrailsAutoConfiguration {
    static void main(String[] args) {
        GrailsApp.run(Application, args)
    }

    @Bean
    MyRabbitContextStartingEventListener myRabbitContextStartingEventListener() {
        return new MyRabbitContextStartingEventListener()
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">src/main/groovy/com/example/MyRabbitContextStartingListener.groovy</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">package com.example

import com.budjb.rabbitmq.event.RabbitContextStartingEvent
import org.springframework.context.ApplicationListener

class MyRabbitContextStartingListener implements ApplicationListener&lt;RabbitContextStartingEvent&gt; {
    @Override
    void onApplicationEvent(RabbitContextStartingEvent event) {
        println "received a RabbitContextStartingEvent event"
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rabbit_context">6.3. Rabbit Context</h3>
<div class="paragraph">
<p>Besides the <code>rabbitMessagePublisher</code>, the <code>rabbitContext</code> is the bean users will most likely interact with.
While you may never need to use this bean, it can be useful.  As with any Spring bean, the <code>rabbitContext</code> can be
injected into any Spring managed bean, such as services, controllers, and rabbit consumers.</p>
</div>
<div class="paragraph">
<p>The <code>rabbitContext</code> is intended to be used as a front-end to all of the other beans defined by the plugin to hide
some of the complexity of interacting with the system. As such, in most cases the <code>rabbitContext</code> proxies requests
to the appropriate manager bean to accomplish the requested task.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
In some cases, interactions with multiple managers are necessary to safely carry out the action. Therefore, unless
the <code>rabbitContext</code> does not provide the required functionality, it should be considered best-practice to use
the <code>rabbitContext</code> instead of the other beans directly.  If you find that you are frequently resorting to using
one of the other beans, I encourage you to post an issue on the GitHub project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The follow subsections describe some of the more useful functionality the <code>rabbitContext</code> provides.</p>
</div>
<div class="sect3">
<h4 id="_native_objects">6.3.1. Native Objects</h4>
<div class="paragraph">
<p>The main goal of the plugin is to effectively wrap the RabbitMQ library to hide the complexity of its usage and
make using it more inline with the conventions of Grails applications, but also allow users to gain access to the
underlying RabbitMQ objects if needed.  <code>rabbitContext</code> provides several methods to gain direct access to the
RabbitMQ Java library <code>Connection</code> and <code>Channel</code> objects.</p>
</div>
<div class="paragraph">
<p>To create a new <code>Channel</code>, use the <code>createChannel</code> methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// This creates a new channel with the default connection
Channel channel = rabbitContext.createChannel()

// The same using a different connection based on its name
Channel channel = rabbitContext.createChannel("connection1")</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If the <code>createChannel</code> methods are used, it is important that these channels are closed. The plugin handles opening
and closing channels that it manages as part of publishing or consuming messages, but channels created with the
<code>createChannel</code> methods are not managed by the plugin.  It is the author&#8217;s responsibility to close them, or connection
leaks may and memory leaks most likely will occur.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use the <code>getConnection</code> methods to gain access to the <code>Connection</code> objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// To retrieve the Connection from the default connection
Connection connection = rabbitContext.getConnection()

// To retrieve the Connection from a specific connection based on its name
Connection connection = rabbitContext.getConnection("connection1")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_starting_and_stopping_connections">6.3.2. Starting and Stopping Connections</h4>
<div class="paragraph">
<p>The plugin handles starting and stopping connections automatically when the application is started or shut down, but
sometimes applications may need to manually stop connections based on certain conditions or business logic. The
<code>rabbitContext</code> contains several methods to manage the life cycle of connections.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startConnections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starts all registered connections.  If some connections are already started, the remainder
                        will also be started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stopConnections</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stops all connections and all consumers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startConnection</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starts a connection based on its name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stopConnection</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stops a connection based on its name, and stops any consumers on the connection.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_starting_and_stopping_consumers">6.3.3. Starting and Stopping Consumers</h4>
<div class="paragraph">
<p>Much like connections, the <code>rabbitContext</code> provides several methods to start and stop consumers if necessary.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startConsumers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starts all registered consumers.  If some consumers are already started, the remainder
                                will also be started.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stopConsumers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stops all consumers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startConsumer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starts a connection based on its class name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stopConsumer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stops a connection based on its class name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>startConsumers(String)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starts all consumers on a specific connection, based on the connection name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>stopConsumers(String)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stops all consumers on a specific connection, based on the connection name.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_status_report">6.3.4. Status Report</h4>
<div class="paragraph">
<p>The <code>RabbitContext</code> contains a method <code>getStatusReport()</code>, which will build an object structure
containing information about all RabbitMQ connections and all consumers. This information is useful
to monitor the status of the RabbitMQ application system, as it contains running states and statistics including
how many concurrent threads a consumer is configured for, how many are actually active, and how many are actively
processing messages.  Below is an example of its output gathered from one of the plugin&#8217;s tests, serialized as JSON.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-json" data-lang="json">[
    {
        "consumers": [
            {
                "fullName": "com.budjb.rabbitmq.test.AllTopicConsumer",
                "load": 0,
                "name": "AllTopicConsumer",
                "numConfigured": 1,
                "numConsuming": 1,
                "numProcessing": 0,
                "queue": "topic-queue-all",
                "runningState": "RUNNING"
            },
            {
                "fullName": "com.budjb.rabbitmq.test.ReportingConsumer",
                "load": 0,
                "name": "ReportingConsumer",
                "numConfigured": 1,
                "numConsuming": 1,
                "numProcessing": 0,
                "queue": "reporting",
                "runningState": "RUNNING"
            },
            {
                "fullName": "com.budjb.rabbitmq.test.SleepingConsumer",
                "load": 0,
                "name": "SleepingConsumer",
                "numConfigured": 1,
                "numConsuming": 1,
                "numProcessing": 0,
                "queue": "sleeping",
                "runningState": "RUNNING"
            },
            {
                "fullName": "com.budjb.rabbitmq.test.SpecificTopicConsumer",
                "load": 0,
                "name": "SpecificTopicConsumer",
                "numConfigured": 1,
                "numConsuming": 1,
                "numProcessing": 0,
                "queue": "topic-queue-specific",
                "runningState": "RUNNING"
            },
            {
                "fullName": "com.budjb.rabbitmq.test.StringConsumer",
                "load": 0,
                "name": "StringConsumer",
                "numConfigured": 1,
                "numConsuming": 1,
                "numProcessing": 0,
                "queue": "string-test",
                "runningState": "RUNNING"
            },
            {
                "fullName": "com.budjb.rabbitmq.test.SubsetTopicConsumer",
                "load": 0,
                "name": "SubsetTopicConsumer",
                "numConfigured": 1,
                "numConsuming": 1,
                "numProcessing": 0,
                "queue": "topic-queue-subset",
                "runningState": "RUNNING"
            }
        ],
        "host": "localhost",
        "name": "connection1",
        "port": 5672,
        "runningState": "RUNNING",
        "virtualHost": "test1.rabbitmq.budjb.com"
    },
    {
        "consumers": [
            {
                "fullName": "com.budjb.rabbitmq.test.Connection2Consumer",
                "load": 0,
                "name": "Connection2Consumer",
                "numConfigured": 1,
                "numConsuming": 1,
                "numProcessing": 0,
                "queue": "connection2-queue",
                "runningState": "RUNNING"
            }
        ],
        "host": "localhost",
        "name": "connection2",
        "port": 5672,
        "runningState": "RUNNING",
        "virtualHost": "test2.rabbitmq.budjb.com"
    }
]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transactions">6.4. Transactions</h3>
<div class="paragraph">
<p>The plugin provides a bit of automation around channel transactions. When a consumer is defined with the <code>transacted</code> property set to <code>true</code>, a transaction is automatically started on
the channel passed to the message handler. When the message handler completes successfully, the transaction is automatically committed. If an unhandled exception is thrown from the message
handler, the transaction is automatically rolled back.</p>
</div>
<div class="paragraph">
<p>It is <strong>especially important</strong> that any messages published from a message handler use the <code>Channel</code> instance passed in the <code>MessageContext</code> for this functionality to work.</p>
</div>
<div class="paragraph">
<p>Since the <code>Channel</code> is passed in the <code>MessageContext</code>, the author has full control over committing and rolling back transactions.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_upgrading">7. Upgrading</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When an update to the plugin is made that has incompatibility considerations, this document will help identify the
various impact considerations when upgrading to a new version.</p>
</div>
<div class="sect2">
<h3 id="_from_3_0_x">7.1. From 3.0.X</h3>
<div class="paragraph">
<p>The upgrade from 3.0.X to 3.1.X includes a refactor of how the consumer and connection managers work.
The storage of consumer handlers was moved from the connection classes into the consumer manager in order
to support the new start/stop functionality, and it made sense for consumer handlers to reside with
the appropriately named manager.</p>
</div>
<div class="paragraph">
<p>Both of the managers also now have underlying interfaces that define how a manager should behave. In addition,
the objects being managed are now called <strong>Contexts</strong>, which also have interfaces that define their general
behavior.  It is the intention that with these changes the plugin becomes more stable with less backwards-
compatibility breaking changes being introduced moving forward.</p>
</div>
<div class="paragraph">
<p>Here are the items authors may need to address when upgrading to this version of the plugin.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>rabbitContext.getConnection()</code> methods now return the RabbitMQ <code>Connection</code> object instead of
the <code>ConnectionContext</code> instance.  This was done to make the methods more consistent with the
<code>createChannel</code> methods and to encapsulate the <code>ConnectionContext</code> objects inside the manager.
The <code>ConnectionContext</code> objects can now be retrieved from the <code>consumerManager</code> bean.</p>
</li>
<li>
<p>Many of the methods inside of the <code>ConsumerManager</code> and <code>ConnectionManager</code> have been renamed to adhere
to a common interface.  This should only affect projects that use these beans directly.</p>
</li>
<li>
<p>Some of the methods inside of the <code>RabbitContext</code> have been renamed to match the interface used by
the various managers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Overall, users of the plugin should see no impact if the <code>rabbitContext</code> or any of the other beans are
not used in their projects.</p>
</div>
<div class="paragraph">
<p>If the use of the plugin&#8217;s beans is limited to the <code>rabbitContext</code>, the impact should be minimal,
with some minor changes need to method names and some refactored code if retrieving a <code>ConnectionContext</code>.
Users that use the other manager beans will need to account for the changed interface implemented by
those beans.</p>
</div>
</div>
<div class="sect2">
<h3 id="_from_2_0_x">7.2. From 2.0.X</h3>
<div class="paragraph">
<p>The upgrade from any version in the 2.0.X range to 3.0.X includes a massive refactoring of the internals of the plugin.  If users did not extend or override
the <code>RabbitContext</code>, <code>RabbitMessageBuilder</code>, or any of the other helper classes, the amount of impact is limited to a couple package name changes.</p>
</div>
<div class="paragraph">
<p>Below are the changes that were made, at a high level:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>RabbitMessageBuilder</code> is deprecated.  The class still exists and its interface is the same, however, the code in the class has been ripped out and now proxies requests to the <code>rabbitMessagePublisher</code> bean.  The builder will be removed at some point in the near future.</p>
</li>
<li>
<p><code>RabbitContext</code> used to contain a significant amount of code related to management of message converters, consumers, and connections.  That functionality has been broken out into their own respective classes.  The <code>RabbitContext</code> now serves only as a class to aggregate functionality useful to users of the plugin, and should still be used to simplify interfacing with the plugin rather than using the underlying beans directly.</p>
</li>
<li>
<p>Introduced the <code>rabbitMessagePublisher</code> as a replacement for the <code>RabbitMessageBuilder</code>.  This bean can be injected into other spring managed beans, such as services, controllers, and rabbit consumers.  Its functionality follows the builder closely, and users may send messages based on configurations made through closures or through the new <code>RabbitMessageProperties</code> object.  The short-hand convenience methods are still available as well.</p>
</li>
<li>
<p>Introduced the <code>messageConverterManager</code> bean to handle all operations pertaining to message converters.</p>
</li>
<li>
<p>Introduced the <code>consumerManager</code> bean to handle all operations pertaining to message consumers.</p>
</li>
<li>
<p>Introduced the <code>connectionManager</code> bean to handle all operations pertaining to RabbitMQ connections and channels.</p>
</li>
<li>
<p>Introduced the <code>queueBuilder</code> bean to handle creating configured exchanges and queues.</p>
</li>
<li>
<p>The <code>MessageContext</code> class has been moved into a new package: <code>com.budjb.rabbitmq.consumer</code>.</p>
</li>
<li>
<p>The <code>AutoAck</code> enum has been moved into a new package: <code>com.budjb.rabbitmq.consumer</code>.</p>
</li>
<li>
<p>The <code>ConsumerConfiguration</code> class has been moved into a new package: <code>com.budjb.rabbitmq.consumer</code>.</p>
</li>
<li>
<p>The <code>MessageConvertMethod</code> class has been moved into a new package: <code>com.budjb.rabbitmq.consumer</code>.</p>
</li>
<li>
<p>The <code>ConnectionContext</code> class has been moved into a new package: <code>com.budjb.rabbitmq.connection</code>.</p>
</li>
<li>
<p>The <code>ConnectionConfiguration</code> class has been moved into a new package: <code>com.budjb.rabbitmq.connection</code>.</p>
</li>
<li>
<p>The <code>MessageConverter</code> abstract class has been moved into a new package: <code>com.budjb.rabbitmq.converter</code>.</p>
</li>
<li>
<p>All of the bundles message converters have been moved into a new package: <code>com.budjb.rabbitmq.converter</code>.</p>
</li>
<li>
<p>The <code>RabbitMessageBuilder</code> class has been moved into a new package: <code>com.budjb.rabbitmq.publisher</code>.</p>
</li>
<li>
<p>A large amount of unit tests and some integration tests have been added to the project.  These tests rely on the Spock mocking framework, but the test files and dependencies are not exported with the plugin so that a new plugin dependency on Spock is not created.</p>
</li>
<li>
<p>The closures used for publishing messages have had their resolving strategy changed from <code>OWNER_FIRST</code> to <code>DELEGATE_FIRST</code>. This should not have much of an impact, but in some cases closures may need to explicity qualify some properties in the closures with <code>delegate</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reference">8. Reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_command_line">8.1. Command Line</h3>
<div class="sect3">
<h4 id="_create_consumer">8.1.1. create-consumer</h4>
<div class="paragraph">
<p>The <code>create-consumer</code> command creates a new consumer or consumers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">grails create-consumer com.example.Test</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command is useful to quickly create new consumers, in much the same way as Grails' built-in commands to create new controllers, domains, etc. The generated file is a template that is ready to be configured and used,
and includes a generic message handler.</p>
</div>
<div class="paragraph">
<p>A powerful feature of this script is the ability to create as many consumers as are entered on the command line. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">grails create-consumer com.example.First com.example.Second</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above will create two consumers: <code>FirstConsumer</code> and <code>SecondConsumer</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_consumer_configuration">8.2. Consumer Configuration</h3>
<div class="sect3">
<h4 id="_autoack">8.2.1. autoAck</h4>
<div class="paragraph">
<p>Sets whether incoming messages should be automatically acknowledged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    queue: "example.queue",
    autoAck: AutoAck.POST
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are 3 auto-acknowledgement modes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enum Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Effect</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AutoAck.MANUAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message is never automatically acknowledged. The message handler is responsible for acknowledging the message.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AutoAck.ALWAYS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message will be automatically acknowledged <strong>before</strong> the message is delivered the message handler.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AutoAck.POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message will be automatically acknowledged <strong>after</strong> the message handler successfully completes. If an unhandled exception escapes the handler, the message is rejected. This is the default mode.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_binding">8.2.2. binding</h4>
<div class="paragraph">
<p>Set the binding criteria to use when subscribing to an exchange.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    exchange: "example.exchange",
    binding: "example.routing.key"
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The binding criteria may be necessary depending on the type of exchange is being subscribed to.
This property is ignored when consuming from a queue. See the guide for more information on this property&#8217;s usage.</p>
</div>
</div>
<div class="sect3">
<h4 id="_connection">8.2.3. connection</h4>
<div class="paragraph">
<p>Sets which connection should be used to consume messages from.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    queue: "foobar",
    connection: "server1"
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The connection property should be used in multi-server configurations to specify which connection should be used to consume messages from.
If the connection property is omitted, the default connection will be used.</p>
</div>
</div>
<div class="sect3">
<h4 id="_consumers">8.2.4. consumers</h4>
<div class="paragraph">
<p>Set the number of concurrent consumers the message consumer should start.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    queue: "example.queue",
    consumers: 10
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, a message consumer class will only start one consumer. This means the consumer can only handle one message at a time. Authors can increase the number of concurrent consumers are running by
increasing the value of this property.</p>
</div>
</div>
<div class="sect3">
<h4 id="_convert">8.2.5. convert</h4>
<div class="paragraph">
<p>Sets the automatic message body conversion mode.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    queue: "example.queue",
    convert: MessageConvertMethod.ALWAYS
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are 3 convert modes:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enum Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Effect</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MessageConvertMethod.DISABLED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message is never automatically converted. The message handler always receives a byte array.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MessageConvertMethod.HEADER</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message will only be automatically converted if the incoming message has the content-type property set and a matching converter is found based on that content-type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MessageConvertMethod.ALWAYS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message will be automatically converted as long as a suitable message converter and message handler are found. This is the default mode.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_exchange">8.2.6. exchange</h4>
<div class="paragraph">
<p>Set the exchange to subscribe to.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    exchange: "example.exchange"
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tells the plugin that the consumer should subscribe to an exchange. The exchange must already exist for the consumer to beginn listening to it. Exchanges can be created externally from the application, or via the
application&#8217;s RabbitMQ configuration. Note that a routing key might be necessary depending on the type of exchange is specified.</p>
</div>
</div>
<div class="sect3">
<h4 id="_match">8.2.7. match</h4>
<div class="paragraph">
<p>Set the match criteria to use when subscribing to a headers exchange.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    exchange: "example.exchange",
    binding: ["foo": "bar"],
    match: "any"
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The match property determines with any one header must match or whether all headers must match for the queue&#8217;s binding. This property
is only used when binding to a headers exchange.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prefetchcount">8.2.8. prefetchCount</h4>
<div class="paragraph">
<p>Sets number of messages the consumer will prefetch.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    queue: "example.queue",
    prefetchCount: 1
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sets the QOS prefetch count property of the consumer&#8217;s channel. By default, the consumer will fetch one message at a time. Increasing this value will increase the number of messages the consumer will queue up before it processes them.</p>
</div>
</div>
<div class="sect3">
<h4 id="_queue">8.2.9. queue</h4>
<div class="paragraph">
<p>Set the queue to consume from.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    queue: "example.queue"
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tells the plugin that the consumer should consume a specific queue. The queue must already exist for the consumer to beging listening to it. Queues can be created externally from the application, or via the
application&#8217;s RabbitMQ configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="_retry">8.2.10. retry</h4>
<div class="paragraph">
<p>Sets whether a rejected message should be redelivered.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    queue: "example.queue",
    retry: false
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a message is rejected, this property is used to determine whether the message should be marked for redelivery.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If a message is rejected because of an unhandled exception, for example, that will repeat every time the message is consumed, the message will be retried indefinitely if enabled. Be careful when using this feature.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_transacted">8.2.11. transacted</h4>
<div class="paragraph">
<p>Sets whether automatic transactions should be enabled on the consumer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">static rabbitConfig = [
    queue: "example.queue",
    transacted: true
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#_transactions">Transactions</a> documentation for more information.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rabbit_message_publisher">8.3. Rabbit Message Publisher</h3>
<div class="sect3">
<h4 id="_appid">8.3.1. appId</h4>
<div class="paragraph">
<p>Sets the appId property of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    appId = "example"
    body = "test message"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_autoconvert">8.3.2. autoConvert</h4>
<div class="paragraph">
<p>Toggles whether the message will be converted via the message converters when a response is received from an RPC message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    body = "test message"
    autoConvert = true
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If this value is <code>true</code>, the same logic to convert messages in the message consumers is used to convert the received message from a byte array to a converted object type, if one exists.
If this is <code>false</code>, the raw byte array is returned from the RPC response.</p>
</div>
</div>
<div class="sect3">
<h4 id="_body">8.3.3. body</h4>
<div class="paragraph">
<p>Body of the message to send to the RabbitMQ server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    body = "test message"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The body is a required part of the message to transmit. The RabbitMQ server expects the message to be in a byte array format, but the plugin attempts to handle the conversion of objects for you via the
<a href="#_message_converters">Message Converters</a> objects. You may assign any type of object to this property as long as there is a message converter available to convert the object to a byte array.</p>
</div>
</div>
<div class="sect3">
<h4 id="_connection_2">8.3.4. connection</h4>
<div class="paragraph">
<p>Sets which connection should be used to send the message to.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    exchange = "example.exchange"
    routingKey = "example.topic"
    body = "message"
    connection = "server1"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The connection property is used to specify which server to send a message with in a multi-server configuration.
If the connection is omitted, the default connection will be used.</p>
</div>
</div>
<div class="sect3">
<h4 id="_contentencoding">8.3.5. contentEncoding</h4>
<div class="paragraph">
<p>Sets the content encoding property of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    contentEncoding = "base64"
    body = "test message"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_contenttype">8.3.6. contentType</h4>
<div class="paragraph">
<p>Sets the content-type property of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    contentType = "text/plain"
    body = "test message"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_correlationid">8.3.7. correlationId</h4>
<div class="paragraph">
<p>Sets the application correlation ID of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    correlationId = "1234"
    body = "test message"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_deliverymode">8.3.8. deliveryMode</h4>
<div class="paragraph">
<p>Sets the delivery mode of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    deliveryMode = 1
    body = "test message"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Values are either Non-persistent (<code>1</code>) or persistent (<code>2</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_exchange_2">8.3.9. exchange</h4>
<div class="paragraph">
<p>Define the exchange to publish a message to.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    exchange = "example.exchange"
    body = "message"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting this property lets the <code>rabbitMessagePublisher</code> know to publish the message to an exchange. Depending on the type of exchange, the use of the <a href="#_routingkey">routingKey</a>
property may be necessary. See the RabbitMQ documentation for more information on exchanges.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A publish operation with the <code>rabbitMessagePublisher</code> may only be done with either an exchange or a queue, but not both.  Attempting to use both will result in an error.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_expiration">8.3.10. expiration</h4>
<div class="paragraph">
<p>Sets the expiration property of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    expiration = "Tuesday, October 22nd 2013"
    body = "test message"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_headers">8.3.11. headers</h4>
<div class="paragraph">
<p>Attached headers to send with the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    headers = [
        "header1": "foo",
        "header2": "bar"
    }
    body = "test message"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The headers property is simply a map with key/value pairs for the header names and their values.</p>
</div>
</div>
<div class="sect3">
<h4 id="_messageid">8.3.12. messageId</h4>
<div class="paragraph">
<p>Sets the messageId property of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    messageId = "1234"
    body = "test message"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_priority">8.3.13. priority</h4>
<div class="paragraph">
<p>Sets the priority of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    priority = 5
    body = "test message"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Message priority is an integer with values from <code>0</code> to <code>9</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_replyto">8.3.14. replyTo</h4>
<div class="paragraph">
<p>Sets the replyTo queue name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    replyTo = "reply.queue"
    body = "test message"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting the <code>replyTo</code> property of the message lets the consumer know that the publisher expects a response to the message. The value of this property should be an existent queue the client is consuming on.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This property is automatically set when the <code>RabbitMessagePublisher.rpc()</code> method is used, and the consumer has access to this property to reply to the message.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_routingkey">8.3.15. routingKey</h4>
<div class="paragraph">
<p>The routing key is used in conjunction with an exchange to publish a message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    exchange = "example.exchange"
    routingKey = "example.topic"
    body = "message"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The routing key is useful when publishing messages to <strong>topic</strong> or <strong>direct</strong> exchanges. When used on <strong>direct</strong> exchanges, the routing key must match
the binding a queue used to bind to an exchange, or the message will become unroutable (and possibly lost). See the RabbitMQ documentation for
more information on routing keys and exchanges.</p>
</div>
<div class="paragraph">
<p>The <code>exchange</code> can be omitted, in which case the <code>routingKey</code> can be used to send a message directly to a queue.</p>
</div>
</div>
<div class="sect3">
<h4 id="_timeout">8.3.16. timeout</h4>
<div class="paragraph">
<p>Sets the amount of time, in milliseconds, an RPC message will wait before giving up.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    timeout = 20 * 60 * 1000 // 20 seconds
    body = "message"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The timeout is important when sending RPC messages. A server may fail and not reply to the message, and the client must not wait until eternity for the message to come back. The default
timeout, if not specified, is 5 seconds. If the client does wish to wait indefinitely, setting this value to 0 will cause the RPC call to wait until a reply is received.</p>
</div>
</div>
<div class="sect3">
<h4 id="_timestamp">8.3.17. timestamp</h4>
<div class="paragraph">
<p>Sets the timestamp property of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    timestamp = Calendar.getInstance()
    body = "test message"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_type">8.3.18. type</h4>
<div class="paragraph">
<p>Sets the type property of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    type = "type"
    body = "test message"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_userid">8.3.19. userId</h4>
<div class="paragraph">
<p>Sets the userId property of the message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rabbitMessagePublisher.send {
    routingKey = "example.queue"
    userId = "foobar"
    body = "test message"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_changelog">9. Changelog</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_3_5_x">9.1. 3.5.x</h3>
<div class="sect3">
<h4 id="_version_3_5_0">9.1.1. Version 3.5.0</h4>
<div class="ulist">
<ul>
<li>
<p>Update to work with Grails 3.3 (or better).</p>
</li>
<li>
<p>Add <code>Order</code> and <code>Ordered</code> support to message converters.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_4_x">9.2. 3.4.x</h3>
<div class="sect3">
<h4 id="_version">9.2.1. Version</h4>

</div>
<div class="sect3">
<h4 id="_version_3_4_6">9.2.2. Version 3.4.6</h4>
<div class="ulist">
<ul>
<li>
<p>Add some error handling around flushing and destroying the persistence context interceptor. Was unable
to reproduce the error, but this is an attempt to fix a zombie Hibernate session bug.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_4_5">9.2.3. Version 3.4.5</h4>
<div class="ulist">
<ul>
<li>
<p>Added rabbitmq prefix, to avoid conflicts with environment variables. (<a href="http://github.com/budjb/grails-rabbitmq-native/issues/130">#130</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_4_4">9.2.4. Version 3.4.4</h4>
<div class="ulist">
<ul>
<li>
<p>Move the <code>TypeConvertertingMapConverter</code> to a higher converting priority than <code>JsonConverter</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_4_3">9.2.5. Version 3.4.3</h4>
<div class="ulist">
<ul>
<li>
<p>Add top-level exception handling for the internal message handler implementation. This fixes an issue
where Hibernate exceptions closed RabbitMQ channels.</p>
</li>
<li>
<p>Use a different <code>MimeType</code> constructor with built-in message converters to maintain Grails 3.1.x support.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_4_2">9.2.6. Version 3.4.2</h4>
<div class="ulist">
<ul>
<li>
<p>Add configuration option <code>rabbitmq.enableSerializableConverter</code>, which defaults to <code>false</code>. This breaks behavior
with the previous 3.4.x releases but brings it back inline with the behavior of previous versions. This was done
due to unexpected serialization issues with embedded lazy maps returned from the <code>JsonSlurper</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_4_1">9.2.7. Version 3.4.1</h4>
<div class="ulist">
<ul>
<li>
<p>Change from using Spring&#8217;s <code>MimeType.getCharset()</code> to <code>MimeType.getCharSet()</code>. The latter is deprecated but
using it allows Grails 3.1.x to function correctly.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_4_0">9.2.8. Version 3.4.0</h4>
<div class="ulist">
<ul>
<li>
<p>Remove support for legacy connection configuration (<code>rabbitmq.connection</code>).</p>
</li>
<li>
<p>Update RabbitMQ Client library to 4.2.0.</p>
</li>
<li>
<p>Add support for exporting RabbitMQ metrics.</p>
</li>
<li>
<p>Major refactor of the message converter system. These changes are not backwards compatible.</p>
</li>
<li>
<p>Major refactor of the message consumer backend system. Existing consumers are compatible.</p>
</li>
<li>
<p>Migrate documentation to AsciiDoc.</p>
</li>
<li>
<p>Introduce new interfaces for message consumers (<code>UnsupportedMessageHandler</code> and <code>MessageConsumerEventHandler</code>).</p>
</li>
<li>
<p>Added Spring application events for RabbitMQ plugin system start and stop events.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_3_x">9.3. 3.3.x</h3>
<div class="sect3">
<h4 id="_version_3_3_3">9.3.1. Version 3.3.3</h4>
<div class="ulist">
<ul>
<li>
<p>Upgrade codebase to Grails 3.2.</p>
</li>
<li>
<p>Add ability to bind exchanges to exchanges.</p>
</li>
<li>
<p>Migrate from <code>Calendar</code> to <code>OffsetDateTime</code> for message timestamps.</p>
</li>
<li>
<p>Update amqp-client to version 3.6.6. (<a href="http://github.com/budjb/grails-rabbitmq-native/issues/83">#83</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_3_2">9.3.2. Version 3.3.2</h4>
<div class="ulist">
<ul>
<li>
<p>Fix message converter/consumer handler issue where message handler methods with primitive types
(such as <code>int</code>) would not accept the equivalent boxed type (such as <code>Integer</code>).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_3_1">9.3.3. Version 3.3.1</h4>
<div class="ulist">
<ul>
<li>
<p>Reintroduce support for consumer handler methods taking only the <code>MessageContext</code> as a parameter.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_3_0">9.3.4. Version 3.3.0</h4>

</div>
<div class="sect3">
<h4 id="_version_2">9.3.5. Version</h4>
<div class="paragraph">
<p>This version includes changes to the configuration format introduced in 3.2.0. There were issues with YAML configuration
and using the keys as the names of connection, queues, or exchanges where those names had periods in them. There was
no way to escape them, and it broke the configuration parsing code. Due to this, the format had to change. This
decision was not made lightly and I intend on this being the last change to the configuration format.
==== Version
* Changed the configuration format introduced in 3.2.0. This breaks backward compatibility with that version.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_2_x">9.4. 3.2.x</h3>
<div class="sect3">
<h4 id="_version_3_2_0">9.4.1. Version 3.2.0</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A huge thanks to <a href="https://github.com/olliefreeman">Ollie Freeman</a> for his work on this release.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>First non-beta release of the plugin for Grails 3.</p>
</li>
<li>
<p>Deprecate closure-based queue/exchange configuration.</p>
</li>
<li>
<p>Add new map-based configuration that works well with YAML.</p>
</li>
<li>
<p>Removed <code>RabbitMessageBuilder</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_1_x">9.5. 3.1.x</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All versions below refer to the Grails 2.x plugin. The Grails 3.x plugin forked from the Grails 2.x version after
release 3.1.3.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_version_3_1_3">9.5.1. Version 3.1.3</h4>
<div class="ulist">
<ul>
<li>
<p>Add status reports that provides information about all connections and their consumers, including load statistics.</p>
</li>
<li>
<p>Upgrade project to Grails 2.5.4.</p>
</li>
<li>
<p>Remove gpars dependency.</p>
</li>
<li>
<p>Make Grails 2.3 the minimum version of Grails this plugin is intended for.</p>
</li>
<li>
<p>Fix consumer configuration from application config parsing issue (<a href="http://github.com/budjb/grails-rabbitmq-native/issues/73">#73</a>).</p>
</li>
<li>
<p>Refactor message conversion for incoming messages so that conversion to a type only happens if an appropriate handler exists.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_1_2_beta">9.5.2. Version 3.1.2-beta</h4>
<div class="ulist">
<ul>
<li>
<p>Experimental upgrade to Grails 3.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_1_2">9.5.3. Version 3.1.2</h4>
<div class="ulist">
<ul>
<li>
<p>Added graceful shutdown support. See <code>rabbitContext.shutdown()</code>.</p>
</li>
<li>
<p>Added methods to check running state on most managers and contexts.</p>
</li>
<li>
<p>Updated rabbitmq Java library to 3.5.4.</p>
</li>
<li>
<p>Added the <code>gpars</code> plugin as a dependency.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_1_1">9.5.4. Version 3.1.1</h4>
<div class="ulist">
<ul>
<li>
<p>Refactored the code to load a consumer&#8217;s configuration from a static variable so that it works correctly when the
consumer is annotated with <code>@Transactional</code>.
(<a href="http://github.com/budjb/grails-rabbitmq-native/issues/55">#55</a>)</p>
</li>
<li>
<p>Add setter methods for the message TTL (<code>expiration</code>).
(<a href="http://github.com/budjb/grails-rabbitmq-native/issues/56">#56</a>)</p>
</li>
<li>
<p>Fix bug where missing connection configuration values do not allow the use of default values.</p>
</li>
<li>
<p>Remove checked exception from ConsumerManageImpl that does not exist in its interface.
(<a href="http://github.com/budjb/grails-rabbitmq-native/issues/59">#59</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_1_0">9.5.5. Version 3.1.0</h4>
<div class="ulist">
<ul>
<li>
<p>Update the RabbitMQ Client Java library to 3.5.0.</p>
</li>
<li>
<p>Fix an issue that caused unclean shutdowns when redeploying an application using the plugin.
(<a href="http://github.com/budjb/grails-rabbitmq-native/issues/54">#54</a>)</p>
</li>
<li>
<p>Added the ability to start and stop individual connections.
(<a href="http://github.com/budjb/grails-rabbitmq-native/issues/49">#49</a>)</p>
</li>
<li>
<p>Added the ability to start and stop individual consumers.
(<a href="http://github.com/budjb/grails-rabbitmq-native/issues/49">#49</a>)</p>
</li>
<li>
<p>Added the ability to start and stop consumers based on the connection they&#8217;re tied to.
(<a href="http://github.com/budjb/grails-rabbitmq-native/issues/49">#49</a>)</p>
</li>
<li>
<p>Moved consumer adapter storage from the connection context to the consumer manager.</p>
</li>
<li>
<p>Handle <code>Throwable</code> types that were not being handled before in the consumer handling so that channels are not closed
if one of the unhandled errors occurs.
(<a href="http://github.com/budjb/grails-rabbitmq-native/issues/47">#47</a>)</p>
</li>
<li>
<p>Added travis-ci continuous integration for all commits to the plugin.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_0_x">9.6. 3.0.x</h3>
<div class="sect3">
<h4 id="_version_3_0_4">9.6.1. Version 3.0.4</h4>
<div class="ulist">
<ul>
<li>
<p>Fix a null pointer exception when a consumer has no configuration.</p>
</li>
<li>
<p>Add a unit test to test behavior when a consumer has no configuration.</p>
</li>
<li>
<p>Add an integration test to test behavior when sending a message directly to a queue.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_0_3">9.6.2. Version 3.0.3</h4>
<div class="ulist">
<ul>
<li>
<p>Introduced the <code>rabbitMessagePublisher</code> bean to replace the <code>RabbitMessageBuilder</code>.</p>
</li>
<li>
<p>Deprecated the <code>RabbitMessageBuilder</code>.</p>
</li>
<li>
<p>Massive refactor of the internals of the plugin.  See the upgrading page for more detailed information about what has
changed.</p>
</li>
<li>
<p>Added the ability to configure consumers centrally in the application&#8217;s configuration file (thanks Erwan Arzur).</p>
</li>
<li>
<p>Updated RabbitMQ library version to 3.4.3.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_0_2">9.6.3. Version 3.0.2</h4>
<div class="ulist">
<ul>
<li>
<p>Internal release, see 3.0.3.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_0_1">9.6.4. Version 3.0.1</h4>
<div class="ulist">
<ul>
<li>
<p>Internal release, see 3.0.3.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_3_0_0">9.6.5. Version 3.0.0</h4>
<div class="ulist">
<ul>
<li>
<p>Internal Release, see 3.0.3.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_2_0_x">9.7. 2.0.x</h3>
<div class="sect3">
<h4 id="_version_2_0_10">9.7.1. Version 2.0.10</h4>
<div class="ulist">
<ul>
<li>
<p>Fix bug with converters that prevented converters later in the processing list from executing if another convert is
unable to marshall data from bytes.</p>
</li>
<li>
<p>Add <code>enabled</code> flag to the configuration. If false, completely disables the plugin from starting.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_2_0_9">9.7.2. Version 2.0.9</h4>
<div class="ulist">
<ul>
<li>
<p>Additional fix for memory leak associated with RPC calls and auto-recovering connections.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_2_0_8">9.7.3. Version 2.0.8</h4>
<div class="ulist">
<ul>
<li>
<p>Fix bug introduced by rushing the previous fix. Mark consuming = true.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_2_0_7">9.7.4. Version 2.0.7</h4>
<div class="ulist">
<ul>
<li>
<p>Add <code>basicCancel()</code> to <code>RabbitMessageBuilder</code> in an attempt to address a memory leak.</p>
</li>
<li>
<p>Improve cleaning up of resources in RPC calls.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_2_0_6">9.7.5. Version 2.0.6</h4>
<div class="ulist">
<ul>
<li>
<p>Updated copyright notices.</p>
</li>
<li>
<p>Added GString message converter.</p>
</li>
<li>
<p>Updated publishing guide docs to make RabbitMessageBuilder usage more clear (thanks marcDeSantis @GitHub).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_2_0_5">9.7.6. Version 2.0.5</h4>
<div class="ulist">
<ul>
<li>
<p>Added heartbeat configuration for connections (thanks LuisMuniz @GitHub).</p>
</li>
<li>
<p>Refactored Hibernate session support so that Hibernate is no longer a dependency of the plugin, and will now work
with or without Hibernate present.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_2_0_4">9.7.7. Version 2.0.4</h4>
<div class="ulist">
<ul>
<li>
<p>Added multi-server support to all aspects of the plugin.</p>
</li>
<li>
<p>Added SSL support for connections.</p>
</li>
<li>
<p>Added auto-reconnect support for dropped connections.</p>
</li>
<li>
<p>Added logic to wrap a Hibernate session around calls to consumers.</p>
</li>
<li>
<p>Updated the RabbitMQ library to version 3.3.0.</p>
</li>
<li>
<p>Added logging for connection/channel reconnects and channel shutdowns.</p>
</li>
<li>
<p>Changed format for connection configurations. The old style is still supported, but will likely be removed at some
point.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_1_0_x">9.8. 1.0.x</h3>
<div class="sect3">
<h4 id="_version_1_0_3">9.8.1. Version 1.0.3</h4>
<div class="ulist">
<ul>
<li>
<p>Modified the logic to check for the existence of callbacks in consumers.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_1_0_2">9.8.2. Version 1.0.2</h4>
<div class="ulist">
<ul>
<li>
<p>Added a cached thread pool so the user does not need to account for the number of threads consumers require. Set the
default to 0 so that this is the default.</p>
</li>
<li>
<p>Added callbacks for messages: onReceive, onSuccess, onFailure, and onComplete.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_1_0_1">9.8.3. Version 1.0.1</h4>
<div class="ulist">
<ul>
<li>
<p>Remove the maven group from the plugin definition class.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_1_0_0">9.8.4. Version 1.0.0</h4>
<div class="ulist">
<ul>
<li>
<p>Version bump for general release.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_0_2_x">9.9. 0.2.x</h3>
<div class="sect3">
<h4 id="_version_0_2_1">9.9.1. Version 0.2.1</h4>
<div class="ulist">
<ul>
<li>
<p>Fixed a bug with the message handler discovery method that caused generically-typed handlers to get called
incorrectly.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_0_2_0">9.9.2. Version 0.2.0</h4>
<div class="ulist">
<ul>
<li>
<p>Refactored queue/exchange configuration. It is now possible configure queue binding without having to also configure
the exchange being bound to.</p>
</li>
<li>
<p>Added the <code>match</code> property to queue configuration to support headers exchange binding.
<strong>This breaks backwards compatibility.</strong></p>
</li>
<li>
<p>Renaming the <code>routingKey</code> property of the consumer configuration to <code>binding</code> to match queue configuration.
<strong>This breaks backwards compatibility.</strong></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_0_1_x">9.10. 0.1.x</h3>
<div class="sect3">
<h4 id="_version_0_1_8">9.10.1. Version 0.1.8</h4>
<div class="ulist">
<ul>
<li>
<p>Moved the trigger to start consumers on application launch to the bootstrap.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_0_1_7">9.10.2. Version 0.1.7</h4>
<div class="ulist">
<ul>
<li>
<p>Added the <code>prefetchCount</code> option to the consumer configuration. Defaults to 1.</p>
</li>
<li>
<p>Added the <code>threads</code> option to the connection configuration. Defaults to 5.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_0_1_6">9.10.3. Version 0.1.6</h4>
<div class="ulist">
<ul>
<li>
<p>Fixed logic to determine if a consumer is valid.</p>
</li>
<li>
<p>Added support for short-form handlers that only take a single parameter.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_0_1_5">9.10.4. Version 0.1.5</h4>
<div class="ulist">
<ul>
<li>
<p><code>body</code> parameter to the <code>RabbitMessageBuilder</code> is no longer required. It now defaults to an empty byte array.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_0_1_4">9.10.5. Version 0.1.4</h4>
<div class="ulist">
<ul>
<li>
<p>Fix a class visibility issue in the artefact handlers for this plugin.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_0_1_3">9.10.6. Version 0.1.3</h4>
<div class="ulist">
<ul>
<li>
<p>Touch up the consumer template.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_0_1_2">9.10.7. Version 0.1.2</h4>
<div class="ulist">
<ul>
<li>
<p>Add the ability to create multiple consumers at the same time with the <code>create-consumer</code> script (thanks Aaron Brown!).</p>
</li>
<li>
<p>Also create a unit test when creating consumers (thanks Michael Rice!).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_0_1_1">9.10.8. Version 0.1.1</h4>
<div class="ulist">
<ul>
<li>
<p>Throw an exception if the connection configuration is missing on application start (thanks Michael Rice!).</p>
</li>
<li>
<p>Add the <code>create-consumer</code> script (thanks Aaron Brown!).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_version_0_1">9.10.9. Version 0.1</h4>
<div class="ulist">
<ul>
<li>
<p>Code complete/experimental release.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 3.5.0<br>
Last updated 2018-07-08 13:37:52 -05:00
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>
</body>
</html>